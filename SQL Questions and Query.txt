
/*1. Which apps have the highest rating in the given available dataset?*/

SELECT App Highested_rated_apps
FROM playstore_apps
WHERE Rating IN (SELECT MAX(Rating) FROM playstore_apps );


/*2.What are the number of installs and reviews for the above apps? Return the apps with the highest reviews to the top.*/

SELECT app
	  ,reviews
FROM playstore_apps
WHERE Rating IN (SELECT MAX(Rating) FROM playstore_apps )
ORDER BY reviews DESC;

/*3.Which app has the highest number of reviews? Also, mention the number of reviews and category of the app*/
SELECT app
	  ,reviews
	  ,category
FROM playstore_apps
WHERE reviews IN (SELECT MAX(reviews) FROM playstore_apps);

/*4.What is the total amount of revenue generated by the google play store by hosting apps? 
(Whenever a user buys apps  from the google play store, the amount is considered in the revenue)*/
SELECT SUM(CAST(price AS DECIMAL)) revenue
FROM playstore_apps


/*5.Which Category of google play store apps has the highest number of installs? also, find out the total number of installs for that particular category.*/


SELECT category
	  ,total_installs 
FROM ( SELECT Category
			 ,SUM(installs) total_installs
	         ,RANK() OVER(ORDER BY SUM(installs) DESC) rnk
	   FROM playstore_apps
	   GROUP BY Category ) install_rank
WHERE rnk=1


/*6.Which Genre has the most number of published apps?*/
SELECT genres
FROM( 
SELECT genres
	  ,COUNT(DISTINCT app) count_published_apps
	  ,RANK() OVER (ORDER BY COUNT(DISTINCT app) DESC) rnk
FROM playstore_apps
GROUP BY genres
) subquery_rank
WHERE rnk=1

/*7.Provide the list of all games ordered in such a way that the game that has the highest number of installs is displayed on the top
(to avoid duplicate results use distinct)*/

SELECT DISTINCT app
			   ,installs
FROM playstore_apps
WHERE category = 'game'
ORDER BY installs DESC;

/*8.Provide the list of apps that can work on android version 4.0.3 and UP.*/

SELECT app
FROM playstore_apps
WHERE android_ver = '4.0.3 and up';


/*9.How many apps from the given data set are free? Also, provide the number of paid apps.*/

SELECT "type"
	   ,COUNT(1) no_of_apps
FROM playstore_apps
GROUP BY "type";


/*10.Which is the best dating app? (Best dating app is the one having the highest number of Reviews)*/

SELECT app
FROM playstore_apps
WHERE reviews IN (SELECT MAX(reviews) 
				  FROM playstore_apps
				  WHERE LOWER(category) LIKE '%dating%')


		 
/*11.Get the number of reviews having positive sentiment and number of reviews having negative sentiment for the app 10 best foods for you and compare them.*/

SELECT SUM(CASE WHEN sentiment = 'Positive' THEN 1
		   ELSE 0
		   END) no_of_positives
	  ,SUM(CASE WHEN sentiment = 'Negative' THEN 1
		   ELSE 0
		   END) no_of_negatives
FROM playstore_reviews
WHERE app = '10 best foods for you';


/*12.Which comments of ASUS SuperNote have sentiment polarity and sentiment subjectivity both as 1?*/

SELECT translated_review
FROM playstore_reviews
WHERE app ='ASUS SuperNote'
AND sentiment_polarity = '1'
AND sentiment_subjectivity = '1';


/*13.Get all the neutral sentiment reviews for the app Abs Training-Burn belly fat */

SELECT translated_review
FROM playstore_reviews 
WHERE app = 'Abs Training-Burn belly fat'
AND sentiment = 'Neutral';

/*14.Extract all negative sentiment reviews for Adobe Acrobat Reader with their sentiment polarity and sentiment subjectivity*/

SELECT DISTINCT translated_review
			   ,sentiment_polarity
			   ,sentiment_subjectivity
FROM  playstore_reviews 
WHERE app = 'Adobe Acrobat Reader'
AND sentiment='Negative';
